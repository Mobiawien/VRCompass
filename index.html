<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VR Compass - Calcolatrice Gestione Crediti</title>
    <!-- Inclusione di Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">  <!-- Rimosso ./ -->
</head>
<body>
    <nav>
        <button id="btn-show-dashboard" class="nav-button active">Dashboard</button>
        <button id="btn-show-gestione-crediti" class="nav-button">Gestione Crediti</button>
        <button id="btn-show-classifica-vsr" class="nav-button">Gestione Classifica VSR</button>
        <button id="btn-show-analisi" class="nav-button">Analisi</button>
        <button id="btn-show-strategia" class="nav-button">Strategia</button>
        <!-- Spostato qui il badge versione -->
        <span class="version-badge">VRCompass Beta</span>
        <!-- Placeholder per selettore lingua -->
        <div id="language-selector-placeholder" class="language-placeholder">
            Lingua (in costruzione)
        </div>
    </nav>

    <div id="dashboard-view" class="view-section">
        <div id="dashboard-background-content"> <!-- NUOVO CONTENITORE PER LO SFONDO -->

            <!-- Contenitore principale per il layout a due colonne della dashboard -->
            <div class="dashboard-layout">

                <!-- Colonna Sinistra -->
                <div class="dashboard-column-left">
                    <!-- Card: Stato Attuale -->
                    <div class="dashboard-card" id="stato-attuale-card">
                        <div class="dashboard-item">
                            <label for="nome-barca">Nome Barca:</label>
                            <input type="text" id="nome-barca" placeholder="Inserisci nome barca" size="30">
                        </div>
                        <div class="dashboard-item" id="gestione-dati-pulsanti">
                            <span class="dashboard-descriptor" style="width: auto; margin-right: 10px;">Gestione Dati:</span>
                            <button id="btn-esporta-dati" class="dashboard-action-button">Esporta Dati</button>
                            <label for="file-importa-dati" class="dashboard-action-button" style="cursor: pointer;">Importa Dati</label>
                            <input type="file" id="file-importa-dati" accept=".json" style="display: none;">
                        </div>
                        <div class="dashboard-item">
                            <span class="dashboard-descriptor">Punteggio VSR Attuale:</span>
                            <span id="classifica-vsr-attuale" class="valore-display">N/D</span>
                        </div>
                    </div>

                    <!-- Card: Grafico Radar -->
                    <div class="dashboard-card" id="grafico-radar-card">
                        <h3>Radar Punti VSR</h3>
                        <div id="grafico-radar-container" style="max-width: 500px; margin-left:auto; margin-right:auto;">
                            <canvas id="graficoRadarSaluteSlot"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Colonna Destra -->
                <div class="dashboard-column-right">
                    <div class="dashboard-card" id="info-gestione-card">
                        <!-- <h3>VRCompass: Info & Strumenti</h3> --> <!-- Titolo rimosso come richiesto -->
                        
                        <div class="info-gestione-sezione">
                            <h3>Benvenuto in VRCompass!</h3>
                            <p>
                                VRCompass è il tuo alleato strategico per Virtual Regatta Offshore. Più che una bussola per la navigazione in mare, è uno strumento progettato per aiutarti a gestire al meglio la tua strategia di gioco, ottimizzare la classifica VSR, amministrare i crediti e pianificare le tue regate con maggiore consapevolezza.
                                Qui puoi monitorare lo stato della tua barca, analizzare la tua classifica VSR, gestire i crediti di gioco e pianificare le tue mosse.
                            </p>
                            <p>
                                Esplora le sezioni tramite il menu di navigazione per accedere a tutte le funzionalità.
                            </p>
                        </div>

                        <div class="info-gestione-sezione" id="gestione-dati-dashboard">
                            <h3>Gestione Dati Utente</h3>
                            <div id="gestione-dati-section"> <!-- Manteniamo l'ID originale per la logica JS -->
                                <p>
                                    I tuoi dati (nome barca, punteggio VSR e storico regate) sono salvati esclusivamente nel tuo browser (tramite <code>localStorage</code>).
                                    Per sicurezza o per trasferire i dati su un altro dispositivo/browser, puoi esportarli in un file e successivamente importarli.
                                </p>
                                <p style="font-size: 0.9em; margin-top: 10px;">
                                    <strong>Come usare:</strong><br>
                                    - <strong>Esporta Dati:</strong> Clicca sul pulsante "Esporta Dati" (nella card "Stato Attuale") per scaricare un file (<code>VRCompass_backup.json</code>) contenente tutti i tuoi dati attuali. Conserva questo file in un luogo sicuro.<br>
                                    - <strong>Importa Dati:</strong> Clicca sul pulsante "Importa Dati" (nella card "Stato Attuale") per selezionare un file <code>.json</code> precedentemente esportato. I dati nel file sovrascriveranno quelli attualmente presenti nell'applicazione.
                                </p>
                                <!-- Messaggio di promemoria aggiunto -->
                                <p style="margin-top: 15px; font-size: 0.9em; color: #555;">
                                    <strong>Nota:</strong> Dopo ogni modifica ai dati delle gare o alle informazioni generali (come il nome della barca), è consigliabile <strong>esportare nuovamente i dati</strong> per assicurarsi di avere un backup aggiornato.
                                </p>
                            </div>
                        </div>

                        <div class="info-gestione-sezione" id="informativa-dashboard">
                            <h3>Informativa e Disclaimer</h3>
                            <div id="informativa-disclaimer-section"> <!-- Manteniamo l'ID originale per la logica JS -->
                                <p><strong>Gestione dei Dati:</strong> Questa applicazione salva i dati inseriti (nome barca, punteggio VSR, dettagli delle regate) unicamente all'interno del <code>localStorage</code> del tuo browser. Nessun dato viene trasmesso o memorizzato su server esterni. L'utente ha pieno controllo sui propri dati e può cancellarli in qualsiasi momento tramite le impostazioni del proprio browser o utilizzando le funzionalità di esportazione/importazione fornite.</p>
                                <p><strong>Accuratezza e Scopo:</strong> VR Compass è uno strumento di ausilio fornito "così com'è", senza garanzie esplicite o implicite sulla sua accuratezza, completezza o funzionamento continuo. Il suo scopo principale è aiutarti a <strong>tenere traccia e organizzare la tua classifica VSR, fornendo un orientamento per le tue strategie di regata future</strong>, oltre a calcolare crediti e punti VSR. Questi calcoli sono basati su formule note ma potrebbero presentare lievi discrepanze rispetto ai valori ufficiali di Virtual Regatta Offshore a causa di arrotondamenti specifici o logiche interne del gioco non completamente documentate.</p>
                            </div>
                            <!-- I paragrafi Responsabilità e Copyright sono stati spostati più in basso, fuori da questo div -->
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- FINE NUOVO CONTENITORE PER LO SFONDO -->

        <!-- Note a piè di pagina per Responsabilità e Copyright -->
        <div id="dashboard-footer-notes">
            <p><strong>Responsabilità:</strong> Gli sviluppatori di VR Compass non sono responsabili per eventuali perdite di dati, danni o altri problemi derivanti dall'uso di questa applicazione. Si consiglia di utilizzare la funzione di esportazione per creare backup regolari dei propri dati.</p>
            <p><strong>Copyright e Licenza:</strong> Il codice sorgente di questa applicazione sarà rilasciato, al momento della sua pubblicazione, sotto i termini della <a href="./LICENSE" target="_blank" rel="noopener noreferrer">MIT License</a>, che ne definisce le condizioni d'uso, modifica e distribuzione.</p>
        </div>
        <p id="autore-dashboard" class="autore-credits">by Velatopiano-La Casa di Hilde</p>
    </div>

    <div id="gestione-crediti-view" class="view-section" style="display: none;"> <!-- ID Modificato -->
        <h1>Gestione Crediti</h1> <!-- Titolo Modificato -->
        <p>Calcola costi, bonus, crediti vinti, netto e punti VSR per una specifica gara. Determina la classifica minima per recuperare i costi.</p> <!-- Descrizione leggermente aggiornata -->

        <div id="container-principale-calcolatrice"> <!-- Contenitore specifico per la calcolatrice -->
            <div>
                <h2>Tabella dei costi e dei bonus x Cat. economica</h2>
                <table id="tabella1">
                    <thead>
                        <tr>
                            <th scope="col">Costi attrezzature</th>
                            <th scope="col" class="categoria-cell" data-categoria="cat1">cat. 1</th>
                            <th scope="col" class="categoria-cell" data-categoria="cat2">cat. 2</th>
                            <th scope="col" class="categoria-cell" data-categoria="cat3">cat. 3</th>
                            <th scope="col" class="categoria-cell" data-categoria="cat4">cat. 4</th>
                            <th scope="col" class="categoria-cell" data-categoria="cat5">cat. 5</th>
                            <th scope="col" class="categoria-cell" data-categoria="cat6">cat. 6</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="bonus-row"><td>bonus</td><td data-categoria="cat1">2200</td><td data-categoria="cat2">1800</td><td data-categoria="cat3">1400</td><td data-categoria="cat4">1200</td><td data-categoria="cat5">600</td><td data-categoria="cat6">300</td></tr>
                        <tr><td>Foils</td><td data-categoria="cat1" class="attrezzatura-cell">1990</td><td data-categoria="cat2" class="attrezzatura-cell">1660</td><td data-categoria="cat3" class="attrezzatura-cell">1340</td><td data-categoria="cat4" class="attrezzatura-cell">1010</td><td data-categoria="cat5" class="attrezzatura-cell">650</td><td data-categoria="cat6" class="attrezzatura-cell">330</td></tr>
                        <tr><td>Reaching Sail</td><td data-categoria="cat1" class="attrezzatura-cell">1430</td><td data-categoria="cat2" class="attrezzatura-cell">1190</td><td data-categoria="cat3" class="attrezzatura-cell">950</td><td data-categoria="cat4" class="attrezzatura-cell">710</td><td data-categoria="cat5" class="attrezzatura-cell">480</td><td data-categoria="cat6" class="attrezzatura-cell">240</td></tr>
                        <tr><td>Light Sails</td><td data-categoria="cat1" class="attrezzatura-cell">1260</td><td data-categoria="cat2" class="attrezzatura-cell">1050</td><td data-categoria="cat3" class="attrezzatura-cell">840</td><td data-categoria="cat4" class="attrezzatura-cell">630</td><td data-categoria="cat5" class="attrezzatura-cell">420</td><td data-categoria="cat6" class="attrezzatura-cell">210</td></tr>
                        <tr><td>Hard Sails</td><td data-categoria="cat1" class="attrezzatura-cell">1010</td><td data-categoria="cat2" class="attrezzatura-cell">840</td><td data-categoria="cat3" class="attrezzatura-cell">670</td><td data-categoria="cat4" class="attrezzatura-cell">500</td><td data-categoria="cat5" class="attrezzatura-cell">340</td><td data-categoria="cat6" class="attrezzatura-cell">170</td></tr>
                        <tr><td>Winchs pro</td><td data-categoria="cat1" class="attrezzatura-cell">900</td><td data-categoria="cat2" class="attrezzatura-cell">750</td><td data-categoria="cat3" class="attrezzatura-cell">600</td><td data-categoria="cat4" class="attrezzatura-cell">450</td><td data-categoria="cat5" class="attrezzatura-cell">300</td><td data-categoria="cat6" class="attrezzatura-cell">150</td></tr>
                        <tr><td>Hull Polish</td><td data-categoria="cat1" class="attrezzatura-cell">590</td><td data-categoria="cat2" class="attrezzatura-cell">490</td><td data-categoria="cat3" class="attrezzatura-cell">390</td><td data-categoria="cat4" class="attrezzatura-cell">290</td><td data-categoria="cat5" class="attrezzatura-cell">200</td><td data-categoria="cat6" class="attrezzatura-cell">100</td></tr>
                        <tr><td>Magic Furler</td><td data-categoria="cat1" class="attrezzatura-cell">1140</td><td data-categoria="cat2" class="attrezzatura-cell">950</td><td data-categoria="cat3" class="attrezzatura-cell">760</td><td data-categoria="cat4" class="attrezzatura-cell">570</td><td data-categoria="cat5" class="attrezzatura-cell">380</td><td data-categoria="cat6" class="attrezzatura-cell">190</td></tr>
                        <tr><td>VRTex</td><td data-categoria="cat1" class="attrezzatura-cell">1020</td><td data-categoria="cat2" class="attrezzatura-cell">850</td><td data-categoria="cat3" class="attrezzatura-cell">680</td><td data-categoria="cat4" class="attrezzatura-cell">510</td><td data-categoria="cat5" class="attrezzatura-cell">340</td><td data-categoria="cat6" class="attrezzatura-cell">170</td></tr>
                        <tr><td>Comfort lounge</td><td data-categoria="cat1" class="attrezzatura-cell">780</td><td data-categoria="cat2" class="attrezzatura-cell">650</td><td data-categoria="cat3" class="attrezzatura-cell">520</td><td data-categoria="cat4" class="attrezzatura-cell">390</td><td data-categoria="cat5" class="attrezzatura-cell">260</td><td data-categoria="cat6" class="attrezzatura-cell">130</td></tr>
                    </tbody>
                </table>

                <h2>Calcolo posizione classifica per recupero crediti</h2>
                <table id="tabella2">
                    <thead>
                        <tr>
                            <th scope="col">Cat. Econ.</th>
                            <th scope="col">Bonus (Base + Extra)</th>
                            <th scope="col">spesa</th>
                            <th scope="col">spesa effettiva</th>
                            <th scope="col">Pos. x Recupero</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Riga statica per i risultati -->
                        <tr id="calcolatrice-risultati-riga2">
                            <td id="output-cat-econ" class="calculated-result-cell">N/D</td>
                            <td><input type="number" id="input-bonus-totale" value="0" min="0" title="Bonus Base + Extra"></td>
                            <td id="output-spesa" class="calculated-result-cell">N/D</td>
                            <td id="output-spesa-effettiva" class="calculated-result-cell">N/D</td>
                            <td id="output-pos-recupero" class="calculated-result-cell">N/D</td>
                        </tr>
                    </tbody>
                </table>

                <h2>Calcolo crediti e punti VSR</h2>
                <table id="tabella3" aria-label="Calcolo crediti e punti VSR">
                    <thead>
                        <tr>
                            <th scope="col">Livello Gara (VSR)</th>
                            <th scope="col">Classifica Finale</th> <!-- Tradotto -->
                            <th scope="col">Crediti Vinti</th>    <!-- Tradotto -->
                            <th scope="col">Netto Crediti</th>    <!-- Tradotto -->
                            <th scope="col">Punti VSR</th>        <!-- Tradotto -->
                        </tr>
                    </thead>
                    <tbody>
                        <!-- La riga verrà aggiunta/modificata dinamicamente con JavaScript -->
                    </tbody>
                </table>
            </div>

            <div id="istruzioni">
                <h2>Guida all'utilizzo della Gestione Crediti</h2> <!-- Titolo Guida Modificato -->
                <p>
                    Questa sezione è progettata per calcolare il premio in crediti ottenibile nella classifica finale di una regata, in base alla sua categoria economica. Permette di effettuare simulazioni, considerando il bonus di gara e i costi delle attrezzature selezionate, per determinare la classifica minima necessaria per raggiungere il pareggio o generare un profitto in crediti.
                </p>
                <p>
                    Guida rapida all'utilizzo:<br><br>
                    1.  Selezione Categoria Economica: Selezionare con un clic l'intestazione della colonna (cat. 1, cat. 2, ...) corrispondente alla categoria economica della regata nella "Tabella dei costi e dei bonus".<br><br>
                    2.  Selezione Attrezzature: Cliccare sulle celle dei costi delle attrezzature che si intende utilizzare nella "Tabella dei costi e dei bonus". Quando la spesa totale supera il bonus iniziale (visibile nella tabella "Calcolo posizione classifica per recupero crediti"), verrà visualizzata la "Spesa Effettiva" e la "Pos. x Recupero", ovvero la posizione minima in classifica necessaria per recuperare l'investimento.<br><br>
                    3.  Inserimento Bonus Extra: Nel caso di bonus aggiuntivi, inserire l'ammontare nella casella "Bonus" della tabella "Calcolo posizione classifica per recupero crediti".<br><br>
                    4.  Simulazione Risultati: Nella tabella "Calcolo crediti e punti VSR", selezionare il "Livello Gara (VSR)" e inserire una "Classifica Finale" ipotetica per vedere i "Crediti Vinti"*, il "Netto Crediti" e i "Punti VSR" corrispondenti.<br><br>
                    *Nota: I "Crediti Vinti" visualizzati potrebbero differire leggermente dai valori effettivi in gioco a causa del metodo di arrotondamento specifico adottato da Virtual Regatta Offshore.
                </p>
            </div>
        </div> <!-- Fine container-principale-calcolatrice -->
         <p id="autore-calcolatrice" class="autore-credits">Calcolatrice by Velatopiano-La Casa di Hilde</p>
    </div>

    <!-- Sezione Gestione Classifica VSR - AGGIORNATA -->
    <div id="classifica-vsr-view" class="view-section" style="display: none;">
        <h1>Gestione Classifica VSR</h1>

        <div id="container-principale-vsr"> <!-- Nuovo contenitore principale per layout a colonne -->
            <div id="contenuto-vsr"> <!-- Contenitore per il contenuto principale (form, tabelle) -->
                <!-- Blocco per mostrare dati dalla Dashboard -->
                <div style="margin-bottom: 20px; padding: 10px; background-color: #e9ecef; border-radius: 5px;">
                    <strong>Barca:</strong> <span id="nome-barca-display">N/D</span> |
                    <strong>Punteggio VSR attuale:</strong> <span id="classifica-vsr-attuale-display">N/D</span>
                </div>

                <!-- Titolo del form, sarà gestito da JS per cambiare testo -->
                <h2 id="titolo-form-gara">Aggiungi Risultato Gara</h2>
                <!-- Form per aggiungere nuove gare -->
                <form id="form-aggiungi-gara">
                    <label for="data-gara">Data:</label>
                    <input type="date" id="data-gara" name="data-gara" required>

                    <label for="nome-regata">Nome Regata:</label>
                    <input type="text" id="nome-regata" name="nome-regata">

                    <label for="livello-gara-vsr-storico">Livello Gara (VSR):</label>
                    <select id="livello-gara-vsr-storico" name="livello-gara-vsr-storico">
                        <option value="0">Seleziona Livello VSR</option>
                        <option value="VGLOBE">Vendée Globe FC</option> <!-- TESTO MODIFICATO -->
                        <option value="HC">Fuori Categoria</option> <!-- TESTO MODIFICATO -->
                        <option value="LIV1">Livello 1</option> <!-- Valore modificato per coerenza -->
                        <option value="LIV2">Livello 2</option> <!-- Valore modificato per coerenza -->
                        <option value="LIV3">Livello 3</option> <!-- Valore modificato per coerenza -->
                    </select>

                    <label for="classifica-finale-storico">Classifica Finale:</label>
                    <input type="number" id="classifica-finale-storico" name="classifica-finale-storico" min="1" required>

                    <label for="punti-vsr-calcolati">Punti VSR:</label> <!-- Campo chiave per il calcolo -->
                    <input type="number" id="punti-vsr-calcolati" name="punti-vsr-calcolati" step="any" required readonly>

                    <button type="submit">Aggiungi Gara</button>
                </form>

                <!-- Pulsanti per filtrare la visualizzazione dello storico -->
                <div class="filtri-visualizzazione-storico" style="margin-bottom: 10px;">
                    <button id="btn-mostra-tutte-gare" class="nav-button filtro-btn active">Storico Regate (Aggiorna)</button>
                    <button id="btn-mostra-gare-valide" class="nav-button filtro-btn">Mostra Valide per Classifica</button>
                </div>
                <!-- Tabella per visualizzare le gare salvate -->
                <table id="tabella-classifica-vsr">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th style="width: 35%;">Nome Regata</th>
                            <th>Livello</th>
                            <th style="width: 15%;">Classifica Finale</th>
                            <th style="width: 15%;">Punti VSR</th>
                            <th>Stato Punti</th> <!-- Nuova intestazione colonna -->
                            <th id="header-colonna-azioni">Azioni</th> 
                        </tr>
                    </thead>
                    <tbody id="classifica-vsr-tbody">
                        <!-- Righe aggiunte dinamicamente da JavaScript -->
                    </tbody>
                </table>
            </div> <!-- Fine contenuto-vsr -->

                       <div id="istruzioni-vsr-box"> <!-- Box istruzioni spostato qui -->
                <h2>Guida alla Gestione Classifica VSR</h2>
                <p>
                    Questa sezione ti permette di archiviare i risultati delle tue gare e di calcolare automaticamente i Punti VSR guadagnati. VRCompass ti aiuta a monitorare la validità dei tuoi punteggi e a capire come contribuiscono alla tua classifica VSR.
                </p>
                <p>
                    <strong>Inserimento Dati:</strong><br>
                    1.  <strong>Data:</strong> Inserisci la data di conclusione della gara.<br>
                    2.  <strong>Nome Regata:</strong> Inserisci un nome identificativo per la regata.<br>
                    3.  <strong>Livello Gara (VSR):</strong> Seleziona il livello corretto della gara. Questi livelli corrispondono alle categorie ufficiali VRO:
                        <ul>
                            <li><strong>Vendée Globe FC:</strong> Seleziona questa opzione per la Vendée Globe. I punti di questa gara sono gli unici che VRCompass considererà per lo slot "Fuori Categoria" valido per la classifica VSR.</li>
                            <li><strong>Fuori Categoria:</strong> Per eventuali altre rare gare definite HC/FC. I punti verranno registrati ma <strong>non</strong> contribuiranno al punteggio VSR totale calcolato da VRCompass, né occuperanno lo slot "Fuori Categoria" valido.</li>
                            <li><strong>Livello 1, 2, 3:</strong> Seleziona il livello VSR corrispondente alla gara.</li>
                        </ul>
                        <p><em>Nota:</em> VRCompass considera solo i punti di una "Vendée Globe FC" per lo slot "Fuori Categoria". Senza una "Vendée Globe FC" valida, questo slot non contribuirà al punteggio VSR calcolato, che si baserà sui migliori 19 risultati delle altre categorie.</p>
                    4.  <strong>Classifica Finale:</strong> Inserisci la tua posizione finale nella regata.<br>
                    5.  <strong>Punti VSR:</strong> Vengono calcolati e visualizzati automaticamente da VRCompass in base al Livello Gara e alla Classifica Finale (usando la formula <code>PuntiMaxCategoria / (Classifica<sup>0.125</sup>)</code>, arrotondati).<br>
                    6.  Clicca su "Aggiungi Gara" per salvare il risultato nello storico.
                </p>
                <p>
                    <strong>Come Leggere le Tabelle delle Gare:</strong><br>
                    La tabella mostra le tue gare. Usa i pulsanti di filtro:
                    <ul>
                        <li><strong>Storico Regate (Aggiorna):</strong> Visualizza tutte le gare inserite, ordinate dalla più recente. Qui puoi modificare o eliminare le gare.</li>
                        <li><strong>Mostra Valide per Classifica:</strong> Visualizza solo le gare che VRCompass considera per il tuo Punteggio VSR Totale (massimo 20: 1 "Vendée Globe FC", 3 Liv.1, 6 Liv.2, 10 Liv.3, o le migliori 19 se la "Vendée Globe FC" non è valida). Le gare sono raggruppate per livello e ordinate per punti effettivi.</li>
                    </ul>
                    Ogni riga della tabella è colorata da VRCompass per indicare la validità temporale dei punti:
                    <ul>
                        <li><span style="background-color: #d4edda; color: #155724; padding: 2px 5px; border-radius: 3px;">Riga Verde Chiaro</span>: Gara entro 12 mesi (punti al 100%).</li>
                        <li><span style="background-color: #fff3cd; color: #856404; padding: 2px 5px; border-radius: 3px;">Riga Giallo Chiaro</span>: Gara tra 12 e 24 mesi (punti al 50% del loro valore originale).</li>
                        <li><span style="background-color: #e9ecef; color: #6c757d; padding: 2px 5px; border-radius: 3px;">Riga Grigio Chiaro</span>: Gara che non contribuisce al Punteggio VSR Totale. Questo si verifica per gare scadute (oltre 24 mesi) oppure, anche se la gara non è temporalmente scaduta, il suo punteggio non è sufficiente per rientrare tra le migliori 20 selezionate per la classifica (particolarmente visibile nella vista "Mostra Valide per Classifica").</li>
                    </ul>
                    <p>La colonna "Stato Punti" (visibile in "Mostra Valide per Classifica") indica "100%" o "50%" per la contribuzione dei punti.</p>
                    <p><strong>Preavvisi:</strong> Le gare negli ultimi 3 mesi prima di un dimezzamento (100% &rarr; 50%) o scadenza (50% &rarr; 0%) sono evidenziate con un <span style="border-left: 3px solid #dc3545; padding-left: 3px;">bordo rosso a sinistra</span>. In "Mostra Valide per Classifica", lo "Stato Punti" includerà "(Preavviso)".</p>
                    <p>
                        La colonna "Punti VSR" mostra i punti originali in "Storico Regate". In "Mostra Valide per Classifica", mostra i punti <em>effettivi</em> che contribuiscono (100% o 50% del valore originale, colorati di rosso se al 50%). Il "Punteggio VSR attuale" (visibile sopra il form) è sempre calcolato da VRCompass tenendo conto di questi fattori.
                    </p>
                </p>
                <p>
                    Puoi modificare o eliminare gare dalla vista "Storico Regate (Aggiorna)".
                </p>
                    <p style="margin-top: 15px; font-size: 0.9em;">
                        <strong>Consiglio:</strong> Se hai dubbi sulla data di chiusura esatta di una regata passata o sul suo livello VSR, molti team (specialmente quelli più noti e titolati) pubblicano elenchi dettagliati delle regate ufficiali. Consultare queste risorse online può aiutarti a recuperare le informazioni mancanti per compilare accuratamente il tuo storico.
                    </p>
            </div> <!-- Fine istruzioni-vsr-box -->

        </div> <!-- Fine container-principale-vsr -->
        <p id="autore-classifica" class="autore-credits">Gestione Classifica by Velatopiano-La Casa di Hilde</p>
    </div>

    <div id="analisi-view" class="view-section" style="display: none;">
        <h1>Analisi Classifica VSR</h1>
        <p>Visualizza lo stato attuale della tua classifica VSR, i tuoi slot e le scadenze imminenti.</p>

        <div class="analisi-container"> <!-- Contenitore principale per le sezioni di analisi -->

            <div class="analisi-sezione" id="panoramica-slot-vsr">
                <h2>Panoramica Slot VSR</h2>
                <p>Visualizza lo stato attuale dei tuoi slot VSR e identifica le opportunità di miglioramento.</p>
                <div id="slot-vsr-container">
                    <!-- Le informazioni sugli slot verranno popolate qui da JavaScript -->
                    <div class="slot-categoria" id="slot-hc-container">
                        <h3>Fuori Categoria (Max 1 gara)</h3>
                        <div class="slot-info">
                            <div class="slot-info-header">
                                <p class="slot-occupati-info"><strong>Slot Occupati:</strong> <span id="hc-occupati">0</span>/1</p>
                                <p class="slot-punti-categoria"><strong>Punti Categoria:</strong> <span id="hc-punti-categoria">N/A</span></p>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="hc-progress-bar"></div>
                            </div>
                            <p><strong>Punteggio Gara Attuale:</strong> <span id="hc-punti-attuali">N/A</span></p>
                            <div class="gare-slot" id="hc-gare-slot">
                                <!-- Dettaglio gara HC -->
                            </div>
                        </div>
                    </div>
                    <div class="slot-categoria" id="slot-liv1-container">
                        <h3>Livello 1 (Max 3 gare)</h3>
                        <div class="slot-info">
                            <div class="slot-info-header">
                                <p class="slot-occupati-info"><strong>Slot Occupati:</strong> <span id="liv1-occupati">0</span>/3</p>
                                <p class="slot-punti-categoria"><strong>Punti Categoria:</strong> <span id="liv1-punti-categoria">N/A</span></p>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="liv1-progress-bar"></div>
                            </div>
                            <p><strong>Punteggio Minimo Contributivo:</strong> <span id="liv1-min-punti">N/A</span></p>
                            <div class="gare-slot" id="liv1-gare-slot">
                                <!-- Dettaglio gare Livello 1 -->
                            </div>
                        </div>
                    </div>
                    <div class="slot-categoria" id="slot-liv2-container">
                        <h3>Livello 2 (Max 6 gare)</h3>
                        <div class="slot-info">
                            <div class="slot-info-header">
                                <p class="slot-occupati-info"><strong>Slot Occupati:</strong> <span id="liv2-occupati">0</span>/6</p>
                                <p class="slot-punti-categoria"><strong>Punti Categoria:</strong> <span id="liv2-punti-categoria">N/A</span></p>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="liv2-progress-bar"></div>
                            </div>
                            <p><strong>Punteggio Minimo Contributivo:</strong> <span id="liv2-min-punti">N/A</span></p>
                            <div class="gare-slot" id="liv2-gare-slot">
                                <!-- Dettaglio gare Livello 2 -->
                            </div>
                        </div>
                    </div>
                    <div class="slot-categoria" id="slot-liv3-container">
                        <h3>Livello 3 (Max 10 gare)</h3>
                        <div class="slot-info">
                            <div class="slot-info-header">
                                <p class="slot-occupati-info"><strong>Slot Occupati:</strong> <span id="liv3-occupati">0</span>/10</p>
                                <p class="slot-punti-categoria"><strong>Punti Categoria:</strong> <span id="liv3-punti-categoria">N/A</span></p>
                            </div>
                            <div class="progress-bar-container">
                                <div class="progress-bar" id="liv3-progress-bar"></div>
                            </div>
                            <p><strong>Punteggio Minimo Contributivo:</strong> <span id="liv3-min-punti">N/A</span></p>
                            <div class="gare-slot" id="liv3-gare-slot">
                                <!-- Dettaglio gare Livello 3 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <hr class="separatore-analisi" style="margin: 30px 0;"> <!-- Questo HR rimane per separare dalla prossima sezione (simulatore) -->

            <!-- Placeholder per future sezioni come il simulatore -->
            <div class="analisi-sezione" id="simulatore-impatto-gara" style="display: none;"> <!-- Nascosto per ora -->
                <h2>Simulatore Impatto Nuova Gara</h2>
                <p>(Funzionalità futura)</p>
            </div>

        </div> <!-- Fine analisi-container -->

        <p id="autore-analisi" class="autore-credits">Analisi by Velatopiano-La Casa di Hilde</p>
    </div>

    <!-- Nuova Sezione Strategia Classifica VSR -->
    <div id="strategia-view" class="view-section" style="display: none;">
        <h1>Strategia Classifica VSR</h1>
        <p>Ottimizza la tua classifica VSR analizzando le opportunità, le debolezze e le scadenze con un focus strategico.</p>
        
        <!-- Contenitore principale per layout a due colonne -->
        <div id="strategia-layout-container">

            <!-- Colonna sinistra: Grafico a Torta -->
            <div id="strategia-grafico-box">
                 <!-- Contenitore per il Grafico a Torta (Spostato qui) -->
                <div id="grafico-torta-container"> <!-- Manteniamo l'ID per ora, potremmo cambiarlo se necessario -->
                    <h2>Stato Ottimizzazione Slot</h2>
                    <div class="canvas-wrapper-strategia"> <!-- NUOVO WRAPPER PER IL CANVAS -->
                        <canvas id="graficoTortaComposizioneVSR"></canvas>
                    </div>
                    <div class="spiegazione-grafico"> <!-- Stili inline rimossi, verranno messi nel CSS -->
                        <p><strong>Come leggere e usare questo grafico per la tua strategia:</strong></p>
                        <p>Questo grafico a torta è il tuo "check-up" strategico: illustra lo stato di ottimizzazione dei tuoi slot VSR, ponderato per il <strong>potenziale di punteggio massimo</strong> di ciascuna categoria (Vendée Globe FC, Livello 1, Livello 2, Livello 3). Ti aiuta a capire dove stai performando bene e dove hai margini di miglioramento per scalare la classifica.</p>
                        <p>
                            Ogni categoria di gara è rappresentata da un colore. La <strong>dimensione totale</strong> della fetta di una categoria (somma delle parti "Ottimizzato" e "Migliorabile") riflette il suo peso sul potenziale VSR totale.
                        </p>
                        <p>
                            Per ogni categoria, il grafico è diviso in due segmenti che insieme rappresentano il 100% del potenziale di "salute" di quella categoria:
                            <ul>
                                <li>La parte <strong>colorata più intensa ("Ottimizzato")</strong>: Indica la percentuale di "salute" attuale della categoria. Un alto valore qui significa che gli slot sono ben riempiti con gare dai punteggi validi e competitivi.</li>
                                <li>La parte <strong>colorata più tenue ("Migliorabile")</strong>: Mostra la percentuale di "salute" ancora da conquistare per quella categoria. Rappresenta slot vuoti o gare con punteggi che possono essere significativamente migliorati.</li>
                            </ul>
                        </p>
                        <p>
                            <strong>Valori nel tooltip:</strong> Passando il mouse su una fetta, il tooltip mostra:
                            <ul>
                                <li><strong>"Salute slot" (XX%)</strong>: Misura l'<em>efficienza</em> con cui gestisci gli slot di quella categoria (riempimento e qualità media dei punti). Un valore alto è ottimo.</li>
                                <li><strong>"Miglioramento potenziale" (YY%)</strong>: È <code>100% - Salute slot</code>. Indica quanto margine hai per ottimizzare la gestione di quella categoria.</li>
                                <li><strong>Punti VSR: Attuali / Potenziali</strong> (es. "24.606 / 30.000"): Confronta i tuoi punti VSR reali con il massimo teorico per quella categoria.</li>
                                <li><strong>Percentuale del Potenziale Categoria (ZZ%)</strong>: È <code>(Attuali / Potenziali) * 100</code>. Indica quanto sei vicino a massimizzare i punti VSR <em>per quella specifica categoria</em>.</li>
                            </ul>
                        </p>
                        <p><strong>Interpretazione combinata per la strategia:</strong></p>
                        <ul>
                            <li><strong>Bassa "Salute slot" (XX%) e bassa "% Potenziale Cat." (ZZ%):</strong> Area critica! Questa categoria necessita della tua massima attenzione. Devi partecipare a più gare e puntare a migliorare significativamente i tuoi piazzamenti.</li>
                            <li><strong>Alta "Salute slot" (XX%) ma bassa "% Potenziale Cat." (ZZ%):</strong> Le gare che hai inserito sono buone, ma probabilmente hai ancora slot vuoti. Concentrati sul riempire gli slot mancanti con gare di qualità simile.</li>
                            <li><strong>Bassa "Salute slot" (XX%) ma alta "% Potenziale Cat." (ZZ%):</strong> Situazione meno comune. Potrebbe significare che hai riempito molti slot, ma con gare dai punteggi non eccelsi, anche se nel complesso hai già accumulato una buona parte dei punti potenziali. Cerca di sostituire le gare con i punteggi più bassi.</li>
                            <li><strong>Alta "Salute slot" (XX%) e alta "% Potenziale Cat." (ZZ%):</strong> Ottimo lavoro! Questa categoria è ben ottimizzata. Mantieni questo livello e cerca eventuali micro-miglioramenti se possibile.</li>
                        </ul>
                        <p><em>Interattività:</em> Puoi cliccare sulle etichette nella legenda del grafico per mostrare o nascondere le singole fette e analizzare meglio specifiche categorie o stati.</p>
                        <p><em>Obiettivo:</em> Usa queste informazioni per massimizzare le porzioni "Ottimizzate" e ridurre quelle "Migliorabili", avvicinandoti così al tuo punteggio VSR massimo possibile. I suggerimenti strategici specifici che trovi accanto al grafico ti aiuteranno ulteriormente in questo compito.</p>
                    </div>
                </div>
            </div>

            <!-- Colonna destra: Suggerimenti e Monitoraggio Scadenze -->
            <div id="strategia-contenuto-box">
                <div class="analisi-sezione" id="valutazione-strategica-slot">
                    <h2>Valutazione Strategica degli Slot VSR</h2>
                    <p>Analisi delle opportunità e delle debolezze degli slot VSR con un focus sulla difficoltà e la priorità di intervento.</p>
                    <ul id="lista-suggerimenti-strategici-slot">
                        <li class="no-data">Nessun suggerimento strategico disponibile al momento.</li>
                    </ul>
                </div>

                <hr class="separatore-analisi" style="margin: 30px 0;">

                <div class="analisi-sezione" id="monitoraggio-scadenze">
                    <h2>Monitoraggio Scadenze e Dimezzamenti</h2>
                    <p>Tieni sotto controllo le gare che stanno per perdere valore o scadere (prossimi 3 mesi).</p>
                    <div id="scadenze-container">
                        <div class="scadenze-categoria">
                            <h4>Gare in Dimezzamento Imminente (da 100% a 50%)</h4>
                            <ul id="lista-gare-dimezzamento">
                                <li class="no-data">Nessuna gara in dimezzamento imminente.</li>
                            </ul>
                        </div>
                        <div class="scadenze-categoria" style="margin-top: 20px;">
                            <h4>Gare in Scadenza Imminente (da 50% a 0%)</h4>
                            <ul id="lista-gare-scadenza">
                                <li class="no-data">Nessuna gara in scadenza imminente.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- Fine strategia-layout-container -->

        <p id="autore-strategia" class="autore-credits">Strategia by Velatopiano-La Casa di Hilde</p>
    </div>

    <script src="script.js"></script>  <!-- Rimosso ./ -->
</body>
</html>
